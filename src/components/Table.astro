---
import LogoTeam from './LogoTeam.astro'
const { class: styles } = Astro.props

const URL = 'https://kings-league-api.lautaronorielasat.workers.dev/leaderboard'

const res = await fetch(URL)
const leaderboard = await res.json()

const CLASSIFIED_STYLES = 'before:content-center before:w-2 before:h-4/5 before:top-1 before:left-1 before:block before:absolute before:bg-gradient-to-b before:from-[#2bc7ff] before:via-[#09f] before:to-[#2bc7ff]'
const MAX_CLASSIFIED_TEAMS = 8
---
<div class={`relative overflow-x-auto shadow-md sm:rounded-lg ${styles}`}>
    <table class="w-full text-sm text-left text-gray-500 border-1 border-gray-200">
        <thead class="text-xs text-white uppercase bg-black">
            <tr class="font-bold">
                <th scope="col" class="px-2 py-3 text-center">
                    Pos
                </th>
                <th scope="col" class="px-2 py-3 text-center">
                    Equipo
                </th>
								<th scope="col" class="px-2 py-3 text-center"></th>
                <th scope="col" class="px-2 py-3 text-center">
                    V
                </th>
                <th scope="col" class="px-2 py-3 text-center">
                    D
                </th>
            </tr>
        </thead>
        <tbody>
					{
						leaderboard.map((team, index) => {
							const { wins, loses, team: teamData } = team
							const { name, image } = teamData
							const position = index + 1

							console.log(team)
							return (
								<tr class="bg-white border-b border-gray-300 text-gray-900 relative">
									<th scope="row" class={`px-2 py-4 text-center font-bold 
										${index < MAX_CLASSIFIED_TEAMS ? CLASSIFIED_STYLES : ''}
									`}>
											{position}
									</th>
									<td class="px-2 py-4 text-center">
										<LogoTeam image={image} class="w-8 mx-auto" name={name}/>
									</td>
									<td class="text-left">
										<strong class="font-semibold">{name}</strong>
									</td>
									<td class="px-2 py-4 text-center">
											{wins}
									</td>
									<td class="px-2 py-4 text-center">
											{loses}
									</td>
							</tr>
							)
						})
					}
        </tbody>
    </table>
</div>
