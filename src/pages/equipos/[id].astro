---
import { getLeaderboardTeam } from '../../../services/leaderboard.js'
import { getPresident } from '../../../services/presidents.js'
import { getTeam } from '../../../services/teams.js'
import ListSocialNetworks from '../../components/ListSocialNetworks.astro'
import Main from '../../components/Main.astro'
import TeamsCards from '../../components/TeamsCards.astro'
import Layout from '../../layouts/Layout.astro'

export const getStaticPaths = async () => {
	const teamsId = ['kunisports', 'los-troncos-fc', '1k', 'pio-fc', 'el-barrio', 'jijantes-fc', 'saiyans-fc', 'aniquiladores-fc', 'xbuyer-team', 'ultimate-mostoles', 'porcinos-fc', 'rayo-barcelona']

	const pages = teamsId.map(id => {
		const params = { params: { id } }
		return params
	})

	return pages
}

const teamId = Astro.params.id
const team = await getTeam(teamId)
const { name, image, color, inverse: imageInverse, socialMedias, presidentId } = team
const { image: presidentImage, name: presidentName } = await getPresident(presidentId)

const teamLeaderboard = await getLeaderboardTeam(teamId)

const socialNetworks = Object.entries(socialMedias)
const styleImage = { backgroundImage: `url(${imageInverse})` }

---

<Layout>
	<Main style={'width: 100%'} >
		<section style={`--tw-gradient-stops:${color},${color}, #f1f1f1;`} class='h-full relative overflow-hidden bg-gradient-to-tr px-16 pt-10 pb-20'>
			<article class="relative z-10 flex justify-between">
				<section>
					<div class="flex items-center">
						<img class="w-40" src={image} alt={name}>
						<div class="flex flex-col items-end gap-y-2">
							<h1 class="text-white text-6xl font-bold ml-8">{name}</h1>
							<nav >
								<ul class="flex gap-x-4 justify-end">
									{
										socialNetworks.map(([social, links]) => {
										if (links.length) {
											const [linkOne, linkTwo] = links
											return (
												<a href={linkOne.href}>
													<li>
														<img class="w-5" src={`/public/social/${social}.svg`} alt={`Logo ${social}`}>
													</li>
												</a>
												<a href={linkTwo.href}>
													<li>
														<img class="w-5" src={`/public/social/${social}.svg`} alt={`Logo ${social}`}>
													</li>
												</a>
											)
										} else {
											return (<a href={links.href}>
													<li>
														<img class="w-5" src={`/public/social/${social}.svg`} alt={`Logo ${social}`}>
													</li>
												</a>)
										}
									})
									}
								</ul>
							</nav>
						</div>
					</div>
					<div class="bg-black text-white grid grid-cols-3 p-4 mt-4 gap-y-4">
							<div class="text-center">
								<h3 class='text-xl text-[#fab60a]'>Victorias</h3>
								<p class="text-3xl">{teamLeaderboard.wins}</p>
							</div>
							<div class="text-center">
								<h3 class='text-xl text-[#fab60a]'>Derrotas</h3>
								<p class="text-3xl">{teamLeaderboard.wins}</p>
							</div>
							<div class="text-center">
								<h3 class='text-xl text-[#fab60a]'>GF</h3>
								<p class="text-3xl">{teamLeaderboard.goalsScored}</p>
							</div>
							<div class="text-center">
								<h3 class='text-xl text-[#fab60a]'>GC</h3>
								<p class="text-3xl">{teamLeaderboard.goalsConceded}</p>
							</div>
							<div class="text-center">
								<h3 class='text-xl text-[#fab60a]'>T.Amarillas</h3>
								<p class="text-3xl">{teamLeaderboard.yellowCards}</p>
							</div>
							<div class="text-center">
								<h3 class='text-xl text-[#fab60a]'>T.Rojas</h3>
								<p class="text-3xl">{teamLeaderboard.redCards}</p>
							</div>
					</div>
				</section>
				<section class="w-52">
					<img src={presidentImage} alt="">
				</section>
			</article>
			<div class="z-0 absolute inset-0 opacity-25 bg-center bg-[length:150%_150%] transition-all" style={styleImage}></div>
			<article>
			</article>
		</section>
		<div class="w-11/12 mx-auto">
			<TeamsCards/>
		</div>
	</Main>
</Layout>
